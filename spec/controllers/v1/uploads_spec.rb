require 'rails_helper'

RSpec.describe V1::UploadsController, type: :controller do
  let(:valid_upload_params) do 
    {
      data: {        
        type: 'uploads',
        attributes: {
          folder_id: Folder.first.id,
          file: 'data:image/png;base64,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'
        }
      }
    }
  end

  let(:invalid_upload_params) do {    
      data: {        
        type: 'uploads',
        attributes: {
          folder_id: Folder.first.id
        }
      }
    }
  end

  let(:acceptable_header) {'application/vnd.api+json'}

  let(:upload) {Upload.first}

  let(:folder) {Folder.first}

  let(:folder_with_uploads) {Folder.includes(:uploads).where.not(uploads: {id: nil}).first}

  context 'request with different headers' do
    it 'GET /v1/uploads and return 406 status code (NOT ACCEPTABLE)' do            
      get :index, params: {folder_id: folder.id}
      expect(response).to have_http_status(:not_acceptable)
    end

    it 'GET /v1/uploads and return 200 status code (ACCEPTABLE)' do
      request.accept = acceptable_header
      get :index, params: {folder_id: folder.id}
      expect(response).to have_http_status(:ok)
    end

    it 'GET v1/uploads/:id' do            
      request.accept = acceptable_header
      get :show, params: {folder_id: upload.folder_id, id: upload.id}
      response_body = JSON.parse(response.body)
      expect(response_body.fetch('data').fetch('id')).to eq(upload.id.to_s)
    end
  end

  context 'requests with valid parameters' do
    it 'POST v1/uploads/' do      
      request.accept = acceptable_header
      post :create, params: { folder_id: valid_upload_params[:data][:attributes][:folder_id], data: valid_upload_params[:data] }
      expect(response).to have_http_status(:created)
    end

    it 'PATCH v1/uploads/:id' do      
      request.accept = acceptable_header      
      valid_upload_params[:data][:id] = upload.id.to_s
      valid_upload_params[:data][:attributes][:file] = "data:image/png;base64,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"
      patch :update, params: { folder_id: upload.folder_id, id: upload.id, data: valid_upload_params[:data] }      
      expect(response).to have_http_status(:ok)
    end

    it 'DELETE v1/uploads/:id' do
      request.accept = acceptable_header
      delete :destroy, params: { folder_id: upload.folder_id, id: upload.id }      
      expect(response).to have_http_status(:no_content)
    end
  end

  context 'POST requests with invalid parameters' do
    it 'POST v1/uploads/' do      
      request.accept = acceptable_header
      post :create, params: { folder_id: invalid_upload_params[:data][:attributes][:folder_id], data: invalid_upload_params[:data] }
      expect(response).to have_http_status(:unprocessable_entity)
    end
  end
end
